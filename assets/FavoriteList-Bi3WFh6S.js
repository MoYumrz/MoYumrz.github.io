import{d as A,e as O,f as Q,w as U,r as g,K as b,c,a as o,i as e,j as t,M as q,N as D,O as M,G as h,m as S,b as G,u as J,s as K,o as i,k as r,t as d,l as m,Q as P,R as X,P as Z,S as ee,E as te,q as se,V as ae,Z as oe,x as ne,W as le,X as ie,Y as re,$ as ce,a0 as de,_ as ue}from"./index-DM1-aU-Q.js";import"./el-infinite-scroll-l0sNRNKZ.js";/* empty css                 */import{p as _e,r as me}from"./index-D6DKQh1_.js";const fe={class:"favorite-list"},ve={class:"title"},pe=["infinite-scroll-disabled"],ge={class:"item"},he={key:0},ye={class:"top"},ke=["onClick"],xe={class:"user-avatar"},Ie={class:"time"},we=["onClick"],Ce={class:"tag-title"},Ee={class:"content"},Te={key:0,class:"covers"},Le={class:"bottom"},Ne={style:{"margin-right":"5px"}},be={class:"comment-like"},De={class:"comment"},Me={class:"like"},Se={key:1},ze={style:{display:"flex","margin-bottom":"5px"}},Be={key:0,style:{"margin-left":"auto",display:"flex","align-items":"center"}},Re={class:"el-dropdown-link"},$e={key:0,class:"loading",style:{display:"flex","justify-content":"center",height:"50px"}},Fe={key:1,class:"no-more-data",style:{display:"flex","justify-content":"center",height:"50px"}},Ve=A({__name:"FavoriteList",setup(je){const I=O(),y=G(),w=J();Q(()=>{k()}),U(()=>y.params.userId,()=>{u.value=[],k()});const f=g(!1),C=b(()=>v.value.current*v.value.pageSize>=E.value),z=b(()=>f.value||C.value),B=()=>{f.value=!0,v.value.current++,k(),f.value=!1},u=g([]),E=g(0),v=g({current:1,pageSize:10}),k=async()=>{try{const l=await _e(Number(y.params.userId),v.value);u.value=u.value.concat(l.data.data.records),E.value=l.data.data.total}catch(l){console.error(l)}},R=l=>{ee.confirm("确定删除该收藏吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{$(l)}).catch(()=>{te.info("已取消删除")})},$=async l=>{try{(await me(l)).data.code===200&&(u.value=u.value.filter(a=>a.postId!==l))}catch(n){console.error(n)}},F=l=>l.replace(/<img[^>]*>/g,"[图片]").replace(/<[^>]*>/g,""),T=l=>{const n=new Date(l),a=new Date,_=a.getTime()-n.getTime();return _<6e4?"刚刚":_<36e5?Math.floor(_/6e4)+"分钟前":_<864e5?Math.floor(_/36e5)+"小时前":_<1728e5?"昨天 ":a.getFullYear()===n.getFullYear()?n.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}).replace(/\//g,"-").replace("，",""):n.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")};return(l,n)=>{const a=K,_=se,L=ae,N=oe,x=ne,V=le,j=ie,H=re,W=ce,Y=de;return i(),c("div",fe,[o("div",ve,[e(a,{size:"large",tag:"b"},{default:t(()=>[r(d(m(I).userInfo.userId==m(y).params.userId?"我的收藏":"收藏"),1)]),_:1})]),u.value.length>0?q((i(),c("div",{key:0,"infinite-scroll-disabled":z.value},[(i(!0),c(D,null,M(u.value,s=>(i(),c("div",ge,[s.title?(i(),c("div",he,[o("div",ye,[o("div",{class:"user",onClick:p=>m(w).push({name:"postList",params:{userId:s.userId}})},[o("div",xe,[e(_,{src:s.avatar},null,8,["src"])]),o("div",null,[e(a,{class:"user-name"},{default:t(()=>[r(d(s.nickname),1)]),_:2},1024)])],8,ke),o("div",Ie,[e(a,null,{default:t(()=>[r(d(T(s.postUpdatedTime)),1)]),_:2},1024)])]),o("div",{class:"center",onClick:p=>m(w).push(`/post/${s.postId}`)},[o("div",Ce,[e(L,{class:"tag",color:s.themeColor,effect:"dark",size:"small",hit:""},{default:t(()=>[r(d(s.sectionName),1)]),_:2},1032,["color"]),e(a,{tag:"b",truncated:"",size:"large",class:"post-title"},{default:t(()=>[r(d(s.title),1)]),_:2},1024)]),o("div",Ee,[e(a,{innerHTML:F(s.content),truncated:!0},null,8,["innerHTML"])]),s.cover!=null?(i(),c("div",Te,[(i(!0),c(D,null,M(JSON.parse(s.cover),p=>(i(),S(N,{style:{width:"120px",height:"120px"},src:p,fit:"cover"},null,8,["src"]))),256))])):h("",!0)],8,we),o("div",Le,[o("div",null,[e(L,{type:"info",class:"tag"},{default:t(()=>[o("div",Ne,[e(N,{style:{width:"20px",height:"20px"},src:s.categoryIcon,fit:"fill"},null,8,["src"])]),o("div",null,[e(a,{class:"tag-name",size:"small"},{default:t(()=>[r(d(s.categoryName),1)]),_:2},1024)])]),_:2},1024)]),o("div",be,[o("div",De,[e(x,null,{default:t(()=>[e(P)]),_:1}),e(a,{class:"comment-count",type:"info"},{default:t(()=>[r(d(s.commentCount),1)]),_:2},1024)]),o("div",Me,[e(x,null,{default:t(()=>[e(X)]),_:1}),e(a,{class:"like-count",type:"info"},{default:t(()=>[r(d(s.likesCount),1)]),_:2},1024)])])])])):(i(),c("div",Se,[o("div",ze,[e(a,null,{default:t(()=>[r("收藏于"+d(T(s.createdTime)),1)]),_:2},1024),m(I).userInfo.userId==s.userId?(i(),c("div",Be,[e(H,{trigger:"click",class:"more",style:{"margin-left":"20px"}},{dropdown:t(()=>[e(j,null,{default:t(()=>[e(V,{onClick:p=>R(s.postId)},{default:t(()=>n[0]||(n[0]=[r("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[o("span",Re,[e(x,{class:"el-icon--right"},{default:t(()=>[e(m(Z))]),_:1})])]),_:2},1024)])):h("",!0)]),e(a,null,{default:t(()=>n[1]||(n[1]=[r("此文章已不存在")])),_:1})]))]))),256)),f.value?(i(),c("div",$e,[e(a,{type:"info"},{default:t(()=>n[2]||(n[2]=[r("正在加载中")])),_:1})])):h("",!0),C.value&&u.value.length>0?(i(),c("div",Fe,[e(a,{type:"info"},{default:t(()=>n[3]||(n[3]=[r("已经到底了")])),_:1})])):h("",!0)],8,pe)),[[Y,B]]):(i(),S(W,{key:1,description:"暂时没有帖子"}))])}}}),Oe=ue(Ve,[["__scopeId","data-v-ebfa8721"]]);export{Oe as default};
