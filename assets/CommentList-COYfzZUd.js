import{d as j,e as F,w as O,f as Y,r as y,K as C,c as l,a as u,i as o,j as t,M as $,N as J,O as R,G as h,m as k,b as A,s as G,o as s,k as d,t as _,l as p,C as K,P,S as Q,E,x as U,W,X,Y as q,$ as H,a0 as Z,_ as ee}from"./index-DM1-aU-Q.js";import"./el-infinite-scroll-l0sNRNKZ.js";/* empty css                 */import{g as te,r as se}from"./index-DFXFkt-n.js";const oe={class:"comment-list"},ae={class:"title"},ne=["infinite-scroll-disabled"],le={class:"item"},re={class:"top"},ie={key:0,style:{"margin-left":"auto",display:"flex","align-items":"center"}},ce={class:"el-dropdown-link"},de={class:"center"},ue={class:"bottom"},_e={key:0},pe={key:1},fe={key:0},me={key:1},ye={key:0,class:"loading",style:{display:"flex","justify-content":"center",height:"50px"}},ge={key:1,class:"no-more-data",style:{display:"flex","justify-content":"center",height:"50px"}},ve=j({__name:"CommentList",setup(he){const w=F(),g=A();O(()=>g.params.userId,()=>{c.value=[],v()}),Y(()=>{v()});const f=y(!1),x=C(()=>m.value.current*m.value.pageSize>=I.value),S=C(()=>f.value||x.value),D=()=>{f.value=!0,m.value.current++,v(),f.value=!1},c=y([]),I=y(0),m=y({current:1,pageSize:10}),v=async()=>{try{const a=await te(Number(g.params.userId),m.value);c.value=c.value.concat(a.data.data.records),I.value=a.data.data.total}catch(a){console.error(a)}},N=a=>{Q.confirm("确定删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{b(a)}).catch(()=>{E.info("已取消删除")})},b=async a=>{try{await se(a),c.value=c.value.filter(e=>e.commentId!=a),E.success("已删除评论")}catch(e){console.error(e)}},B=a=>{const e=new Date(a),n=new Date,r=n.getTime()-e.getTime();return r<6e4?"刚刚":r<36e5?Math.floor(r/6e4)+"分钟前":r<864e5?Math.floor(r/36e5)+"小时前":r<1728e5?"昨天 ":n.getFullYear()===e.getFullYear()?e.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}).replace(/\//g,"-").replace("，",""):e.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")};return(a,e)=>{const n=G,r=U,M=W,T=X,z=q,L=H,V=Z;return s(),l("div",oe,[u("div",ae,[o(n,{size:"large",tag:"b"},{default:t(()=>[d(_(p(w).userInfo.userId==p(g).params.userId?"我的评论":"评论"),1)]),_:1})]),c.value.length>0?$((s(),l("div",{key:0,class:"content","infinite-scroll-disabled":S.value},[(s(!0),l(J,null,R(c.value,i=>(s(),l("div",le,[u("div",re,[o(n,{type:"info"},{default:t(()=>[o(r,{size:"large"},{default:t(()=>[o(p(K))]),_:1})]),_:1}),o(n,{class:"time"},{default:t(()=>[d(_(B(i.createdTime)),1)]),_:2},1024),p(w).userInfo.userId==i.userId?(s(),l("div",ie,[o(z,{trigger:"click",class:"more",style:{"margin-left":"20px"}},{dropdown:t(()=>[o(T,null,{default:t(()=>[o(M,{onClick:ke=>N(i.commentId)},{default:t(()=>e[0]||(e[0]=[d("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),default:t(()=>[u("span",ce,[o(r,{class:"el-icon--right"},{default:t(()=>[o(p(P))]),_:1})])]),_:2},1024)])):h("",!0)]),u("div",de,[o(n,{size:"large",tag:"b",truncated:""},{default:t(()=>[d(_(JSON.parse(i.content)),1)]),_:2},1024)]),u("div",ue,[i.replyId!=null?(s(),k(n,{key:0,type:"info",truncated:""},{default:t(()=>[e[1]||(e[1]=d(" 回复评论： ")),i.replyContent!=null?(s(),l("span",_e,_(JSON.parse(i.replyContent)),1)):(s(),l("span",pe," 此评论已被删除 "))]),_:2},1024)):(s(),k(n,{key:1,type:"info",truncated:""},{default:t(()=>[e[2]||(e[2]=d(" 回复帖子： ")),i.title!=null?(s(),l("span",fe,_(i.title),1)):(s(),l("span",me," 此帖子已被删除 "))]),_:2},1024))])]))),256)),f.value?(s(),l("div",ye,[o(n,{type:"info"},{default:t(()=>e[3]||(e[3]=[d("正在加载中")])),_:1})])):h("",!0),x.value&&c.value.length>0?(s(),l("div",ge,[o(n,{type:"info"},{default:t(()=>e[4]||(e[4]=[d("已经到底了")])),_:1})])):h("",!0)],8,ne)),[[V,D]]):(s(),k(L,{key:1,description:"去帖子底下留下你的评论吧~"}))])}}}),Ee=ee(ve,[["__scopeId","data-v-c3b42dc1"]]);export{Ee as default};
